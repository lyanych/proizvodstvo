<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Выберите ингредиент</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f3f3f3;
        }

        #app {
            text-align: center;
            display: none;
        }

        #main-image {
            width: 200px;
            height: auto;
            margin-bottom: 20px;
        }

        #tools {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        button {
            padding: 10px 20px;
            font-size: 16px;
            margin: 10px;
            cursor: pointer;
        }

        #items {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
        }

        .item {
            text-align: center;
            margin: 20px;
            cursor: pointer;
        }

        .item img {
            width: 150px;
            height: 150px;
            border-radius: 10px;
            transition: transform 0.3s ease;
        }

        .item img:hover {
            transform: scale(1.1);
        }

        .caption {
            margin-top: 10px;
            font-size: 18px;
        }

        #options-list {
            display: none;
            text-align: left;
            margin-top: 10px;
        }

        #options-list li {
            margin-bottom: 5px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div id="items">
        <div class="item" onclick="selectItem('Сырье/виноград.png', 'Виноград')">
            <img src="виноград.png" alt="Виноград">
            <div class="caption">Виноград</div>
        </div>

        <div class="item" onclick="selectItem('Сырье/яблоки.png', 'Яблоки')">
            <img src="яблоки.png" alt="Яблоки">
            <div class="caption">Яблоки</div>
        </div>

        <div class="item" onclick="selectItem('Сырье/фрукты_ягоды.png', 'Фрукты/Ягоды')">
            <img src="фрукты_ягоды.png" alt="Фрукты/Ягоды">
            <div class="caption">Фрукты/Ягоды</div>
        </div>

        <div class="item" onclick="selectItem('Сырье/сахарный_тростник.png', 'Сахарный тростник')">
            <img src="сахарный_тростник.png" alt="Сахарный тростник">
            <div class="caption">Сахарный тростник</div>
        </div>

        <div class="item" onclick="selectItem('Сырье/голубая_агава.png', 'Голубая агава')">
            <img src="голубая_агава.png" alt="Голубая агава">
            <div class="caption">Голубая агава</div>
        </div>

        <div class="item" onclick="selectItem('Сырье/зерно.png', 'Зерно')">
            <img src="зерно.png" alt="Зерно">
            <div class="caption">Зерно</div>
        </div>

    </div>

    <div id="app">
        <img id="main-image" src="" alt="">
        <div id="caption"></div>

        <div id="tools">
            <button onclick="showOptions('additives')">Добавки</button>
            <button onclick="showOptions('processes')">Процессы</button>

            <ul id="options-list"></ul>
        </div>
    </div>

    <script>
        const additives = [
            'Спирт', 'Растения', 'Сахар', 'Дрожжи', 'Полынь', 'Можжевельник',
            'Сок', 'Мягкая вода', 'Колер', 'Хмель', 'Сливки'
        ];

        const processes = [
            'Мацерация (Настаивание)', 'Фильтрация', 'Дистилляция', 'Ректификация', 'Ферментация (Брожение)', 
            'Гомогенизация', 'Выдержка', 'Прессование (Отжим сока)', 'Запекание', 'Замачивание', 
            'Проращивание', 'Сушка', 'Варка с хмелем', 'Разваривание под давлением', 
            'Дробление', 'Гребнеотделение'
        ];

        let selectedItem = null;
        let currentStage = 0;

        function selectItem(imageSrc, captionText) {
            selectedItem = captionText;
            currentStage = 0;
            document.getElementById('items').style.display = 'none';
            document.getElementById('app').style.display = 'block';
            document.getElementById('main-image').src = imageSrc;
            document.getElementById('caption').textContent = captionText;
        }

        function showOptions(type) {
            const optionsList = document.getElementById('options-list');
            optionsList.innerHTML = '';
            optionsList.style.display = 'block';

            let options = [];

            if (type === 'additives') {
                options = additives;
            } else if (type === 'processes') {
                options = processes;
            }

            options.forEach(option => {
                const li = document.createElement('li');
                li.textContent = option;
                li.onclick = () => applyProcess(option);
                optionsList.appendChild(li);
            });
        }

function applyProcess(process) {
    if (selectedItem === 'Виноград') {
        if (process === 'Гребнеотделение' && currentStage === 0) {
            document.getElementById('main-image').src = 'Итог/Виноград/очищенный_виноград.png';
            document.getElementById('caption').textContent = 'Очищенный виноград';
            currentStage = 1;
        } else if (process === 'Ферментация (Брожение)' && currentStage === 1) {
            document.getElementById('main-image').src = 'Итог/Виноград/сброженный_виноград.png';
            document.getElementById('caption').textContent = 'Сброженный виноград';
            currentStage = 2;
        } else if (process === 'Прессование (Отжим сока)') {
            if (currentStage === 2) {
                document.getElementById('main-image').src = 'Итог/Виноград/брага.png';
                document.getElementById('caption').textContent = 'Какая-то брага, но не вино';
                
                // Показать сообщение с кнопкой для повторной попытки
                showAlertWithRetry();
                currentStage = 3;
            } else if (currentStage === 1) {
                document.getElementById('main-image').src = 'Итог/Виноград/виноградный_сок.png';
                document.getElementById('caption').textContent = 'Виноградный сок';
                currentStage = 4;
            }
        } else if (process === 'Мацерация (Настаивание)' && currentStage === 4) {
            document.getElementById('main-image').src = 'Итог/Виноград/красный_виноградный_сок.png';
            document.getElementById('caption').textContent = 'Красный виноградный сок';
            currentStage = 5;
        } else if (process === 'Ферментация (Брожение)' && currentStage === 5) {
            document.getElementById('main-image').src = 'Итог/Виноград/красный_виноматериал.png';
            document.getElementById('caption').textContent = 'Красный виноматериал';
            currentStage = 6;
        } else {
            alert(`Процесс "${process}" не применим к "${selectedItem}" на этом этапе.`);
        }
    }
}

// Функция для показа сообщения с кнопкой "Попробовать снова"
function showAlertWithRetry() {
    const alertDiv = document.createElement('div');
    alertDiv.style.position = 'fixed';
    alertDiv.style.top = '50%';
    alertDiv.style.left = '50%';
    alertDiv.style.transform = 'translate(-50%, -50%)';
    alertDiv.style.backgroundColor = 'white';
    alertDiv.style.border = '1px solid #ccc';
    alertDiv.style.padding = '20px';
    alertDiv.style.boxShadow = '0 0 10px rgba(0, 0, 0, 0.1)';
    alertDiv.style.zIndex = '1000';

    const message = document.createElement('p');
    message.textContent = 'Так ничего не выйдет, попробуйте сначала';
    alertDiv.appendChild(message);

    const retryButton = document.createElement('button');
    retryButton.textContent = 'Попробовать снова';
    retryButton.onclick = () => {
        document.getElementById('items').style.display = 'flex';
        document.getElementById('app').style.display = 'none';
        document.getElementById('main-image').src = '';
        document.getElementById('caption').textContent = '';
        selectedItem = null;
        currentStage = 0;
        document.body.removeChild(alertDiv); // Удалить окно с сообщением
    };
    alertDiv.appendChild(retryButton);

    document.body.appendChild(alertDiv); // Добавить окно с сообщением на страницу
}
    </script>
</body>
</html>
