<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Выберите ингредиент</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f3f3f3;
        }

        #items {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
        }

        .item {
            text-align: center;
            margin: 20px;
            cursor: pointer;
        }

        .item img {
            width: 150px;
            height: 150px;
            border-radius: 10px;
            transition: transform 0.3s ease;
        }

        .item img:hover {
            transform: scale(1.1);
        }

        .caption {
            margin-top: 10px;
            font-size: 18px;
        }

        #app {
            display: none;
            width: 80%;
            max-width: 1200px;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #main-content {
            display: flex;
            width: 100%;
            justify-content: space-between;
            align-items: center;
        }

        #main-image {
            width: 400px;
            height: auto;
            margin: 20px;
        }

        #tools {
            display: flex;
            justify-content: space-between;
            width: 100%;
            max-width: 800px;
        }

        #processes,
        #additives {
            width: 45%;
        }

        #tools div {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .process-item,
        .additive-item {
            text-align: center;
            margin: 10px;
            cursor: pointer;
        }

        .process-item img,
        .additive-item img {
            width: 100px;
            height: 100px;
            border-radius: 10px;
            transition: transform 0.3s ease;
        }

        .process-item img:hover,
        .additive-item img:hover {
            transform: scale(1.1);
        }

        .process-item .caption,
        .additive-item .caption {
            margin-top: 5px;
            font-size: 14px;
        }

        #goToMain {
            margin-top: 20px;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
        }

        .alert {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            border: 1px solid #ccc;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            text-align: center;
        }

        .alert button {
            margin-top: 10px;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div id="items">
        <div class="item" onclick="selectItem('Сырье/виноград.png', 'Виноград')">
            <img src="Сырье/виноград.png" alt="Виноград">
            <div class="caption">Виноград</div>
        </div>
        <!-- Добавь остальные ингредиенты здесь -->
    </div>

    <div id="app">
        <div id="main-content">
            <div id="processes">
                <!-- Процессы будут добавлены динамически -->
            </div>

            <div>
                <img id="main-image" src="" alt="">
                <div id="caption"></div>
            </div>

            <div id="additives">
                <!-- Добавки будут добавлены динамически -->
            </div>
        </div>

        <button id="goToMain" onclick="goToMain()">На главный экран</button>
    </div>

    <script>
        const additives = [
            {name: 'Спирт', src: 'Добавки/спирт.png'},
            {name: 'Растения', src: 'Добавки/растения.png'},
            {name: 'Сахар', src: 'Добавки/сахар.png'},
            // Добавь остальные добавки
        ];

        const processes = [
            {name: 'Мацерация (Настаивание)', src: 'Процессы/мацерация.png'},
            {name: 'Фильтрация', src: 'Процессы/фильтрация.png'},
            {name: 'Дистилляция (перегонка)', src: 'Процессы/дистилляция.png'},
            {name: 'Ректификация', src: 'Процессы/ректификация.png'},
            {name: 'Ферментация (Брожение)', src: 'Процессы/брожение.png'},
            {name: 'Гомогенизация', src: 'Процессы/гомогенизация.png'},
            {name: 'Выдержка', src: 'Процессы/выдержка.png'},
            {name: 'Прессование (Отжим сока)', src: 'Процессы/отжим.png'},
            {name: 'Запекание', src: 'Процессы/запекание.png'},
            {name: 'Варка', src: 'Процессы/варка.png'},
            {name: 'Дробление', src: 'Процессы/дробление.png'},
            {name: 'Гребнеотделение', src: 'Процессы/гребнеотделение.png'},
            {name: 'Соложение', src: 'Процессы/соложение.png'}
        ];

        let selectedItem = null;
        let currentStage = 0;

        function selectItem(imageSrc, captionText) {
            selectedItem = captionText;
            currentStage = 0;
            document.getElementById('items').style.display = 'none';
            document.getElementById('app').style.display = 'flex';
            document.getElementById('main-image').src = imageSrc;
            document.getElementById('caption').textContent = captionText;
            loadOptions();
        }

        function loadOptions() {
            const processesContainer = document.getElementById('processes');
            const additivesContainer = document.getElementById('additives');
            processesContainer.innerHTML = '';
            additivesContainer.innerHTML = '';

            processes.forEach(process => {
                const div = document.createElement('div');
                div.className = 'process-item';
                div.innerHTML = `<img src="${process.src}" alt="${process.name}"><div class="caption">${process.name}</div>`;
                div.onclick = () => applyProcess(process.name);
                processesContainer.appendChild(div);
            });

            additives.forEach(additive => {
                const div = document.createElement('div');
                div.className = 'additive-item';
                div.innerHTML = `<img src="${additive.src}" alt="${additive.name}"><div class="caption">${additive.name}</div>`;
                div.onclick = () => applyAdditive(additive.name);
                additivesContainer.appendChild(div);
            });
        }

        function applyProcess(process) {
            if (selectedItem === 'Виноград') {
                if (process === 'Гребнеотделение' && currentStage === 0) {
                    document.getElementById('main-image').src = 'Итог/Виноград/очищенный_виноград.png';
                    document.getElementById('caption').textContent = 'Очищенный виноград';
                    currentStage = 1;
                } else if (process === 'Ферментация (Брожение)' && currentStage === 1) {
                    document.getElementById('main-image').src = 'Итог/Виноград/сброженный_виноград.png';
                    document.getElementById('caption').textContent = 'Сброженный виноград';
                    currentStage = 2;
                } else if (process === 'Прессование (Отжим сока)') {
                    if (currentStage === 2) {
                        document.getElementById('main-image').src = 'Итог/Виноград/брага.png';
                        document.getElementById('caption').textContent = 'Какая-то брага, но не вино';
                        showAlertWithRetry();
                        currentStage = 3;
                    } else if (currentStage === 1) {
                        document.getElementById('main-image').src = 'Итог/Виноград/виноградный_сок.png';
                        document.getElementById('caption').textContent = 'Виноградный сок';
                        currentStage = 4;
                    } else {
                        showAlertWithRetry();
                    }
                } else if (process === 'Мацерация (Настаивание)' && currentStage === 4) {
                    document.getElementById('main-image').src = 'Итог/Виноград/вино.png';
                    document.getElementById('caption').textContent = 'Вино';
                    currentStage = 5;
                } else {
                    showAlertWithRetry();
                }
            }
        }

        function applyAdditive(additive) {
            if (selectedItem === 'Виноград') {
                if (additive === 'Спирт') {
                    if (currentStage === 5) {
                        document.getElementById('main-image').src = 'Итог/Виноград/вино_с_спиртом.png';
                        document.getElementById('caption').textContent = 'Вино с добавлением спирта';
                        currentStage = 6;
                    } else {
                        showAlertWithRetry();
                    }
                } else if (additive === 'Сахар') {
                    if (currentStage === 5) {
                        document.getElementById('main-image').src = 'Итог/Виноград/вино_с_сахаром.png';
                        document.getElementById('caption').textContent = 'Вино с добавлением сахара';
                        currentStage = 6;
                    } else {
                        showAlertWithRetry();
                    }
                }
            }
        }

        function goToMain() {
            document.getElementById('items').style.display = 'flex';
            document.getElementById('app').style.display = 'none';
            selectedItem = null;
            currentStage = 0;
        }

        function showAlertWithRetry() {
            const alertDiv = document.createElement('div');
            alertDiv.className = 'alert';

            const message = document.createElement('p');
            message.textContent = 'Так ничего не выйдет, попробуйте сначала';
            alertDiv.appendChild(message);

            const retryButton = document.createElement('button');
            retryButton.textContent = 'Попробовать снова';
            retryButton.onclick = () => {
                goToMain();
                document.body.removeChild(alertDiv);
            };
            alertDiv.appendChild(retryButton);

            document.body.appendChild(alertDiv);
        }
    </script>
</body>
</html>
